============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-9.0.2, pluggy-1.6.0 -- C:\Users\Sameer\OneDrive\Desktop\AI_Interview_Backend\.venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\Sameer\OneDrive\Desktop\AI_Interview_Backend
configfile: pytest.ini
plugins: anyio-4.12.1, langsmith-0.6.6, asyncio-1.3.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 24 items

tests/integration/test_candidate_router.py::test_upload_selfie_success PASSED [  4%]
tests/integration/test_candidate_router.py::test_get_history PASSED      [  8%]
tests/integration/test_flow.py::test_full_interview_lifecycle PASSED     [ 12%]
tests/unit/test_cascade_delete.py::TestCheckDeleteEndpoint::test_check_delete_clean_user PASSED [ 16%]
tests/unit/test_cascade_delete.py::TestCheckDeleteEndpoint::test_check_delete_user_with_interviews PASSED [ 20%]
tests/unit/test_cascade_delete.py::TestCheckDeleteEndpoint::test_check_delete_nonexistent_user PASSED [ 25%]
tests/unit/test_cascade_delete.py::TestCascadeDelete::test_delete_candidate_cascades_interviews FAILED [ 29%]
tests/unit/test_cascade_delete.py::TestCascadeDelete::test_delete_clean_user PASSED [ 33%]
tests/unit/test_cascade_delete.py::TestCascadeDelete::test_cannot_delete_self FAILED [ 37%]
tests/unit/test_cloud_robustness.py::test_audio_service_modal_fallback_to_hf PASSED [ 41%]
tests/unit/test_cloud_robustness.py::test_audio_service_skips_local_on_cloud PASSED [ 45%]
tests/unit/test_cloud_robustness.py::test_face_recognizer_builds_sface_even_on_cloud FAILED [ 50%]
tests/unit/test_cloud_robustness.py::test_llm_fallback_to_hf PASSED      [ 54%]
tests/unit/test_interview.py::test_create_interview_session PASSED       [ 58%]
tests/unit/test_interview.py::test_access_interview_invalid_token PASSED [ 62%]
tests/unit/test_interview.py::test_access_interview_valid PASSED         [ 66%]
tests/unit/test_interview.py::test_start_session PASSED                  [ 70%]
tests/unit/test_interview.py::test_submit_answer_text PASSED             [ 75%]
tests/unit/test_interview.py::test_evaluate_answer_modal_fallback PASSED [ 79%]
tests/unit/test_total_score.py::TestTotalScoreInResultDetail::test_total_score_returned_correctly PASSED [ 83%]
tests/unit/test_total_score.py::TestTotalScoreInResultDetail::test_total_score_none_when_not_processed PASSED [ 87%]
tests/unit/test_total_score.py::TestTotalScoreInResultDetail::test_total_score_in_nested_interview_object PASSED [ 91%]
tests/unit/test_total_score.py::TestTotalScoreInResultBrief::test_total_score_in_brief_list PASSED [ 95%]
tests/unit/test_total_score.py::TestTotalScoreInResultBrief::test_zero_score_not_filtered_out PASSED [100%]

================================== FAILURES ===================================
E   AssertionError: assert InterviewSession(access_token='2a9b5b9d933241bcac61de097dfc3c47', max_questions=None, max_warnings=3, start_time=None, id=1, is_suspended=False, end_time=None, suspension_reason=None, admin_id=1, candidate_id=2, suspended_at=None, status=<InterviewStatus.SCHEDULED: 'scheduled'>, invite_link=None, enrollment_audio_path=None, total_score=None, current_status=None, is_completed=False, paper_id=1, last_activity=None, schedule_time=datetime.datetime(2026, 2, 26, 5, 25, 23, 308675), warning_count=0, duration_minutes=60) is None
C:\Users\Sameer\OneDrive\Desktop\AI_Interview_Backend\tests\unit\test_cascade_delete.py:136: AssertionError: assert InterviewSession(access_token='2a9b5b9d933241bcac61de097dfc3c47', max_questions=None, max_warnings=3, start_time=None, id=1, is_suspended=False, end_time=None, suspension_reason=None, admin_id=1, candidate_id=2, suspended_at=None, status=<InterviewStatus.SCHEDULED: 'scheduled'>, invite_link=None, enrollment_audio_path=None, total_score=None, current_status=None, is_completed=False, paper_id=1, last_activity=None, schedule_time=datetime.datetime(2026, 2, 26, 5, 25, 23, 308675), warning_count=0, duration_minutes=60) is None
E   KeyError: 'detail'
C:\Users\Sameer\OneDrive\Desktop\AI_Interview_Backend\tests\unit\test_cascade_delete.py:154: KeyError: 'detail'
E   AssertionError: Expected 'build_model' to be called once. Called 0 times.
C:\Users\Sameer\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:950: AssertionError: Expected 'build_model' to be called once. Called 0 times.
=========================== short test summary info ===========================
FAILED tests/unit/test_cascade_delete.py::TestCascadeDelete::test_delete_candidate_cascades_interviews
FAILED tests/unit/test_cascade_delete.py::TestCascadeDelete::test_cannot_delete_self
FAILED tests/unit/test_cloud_robustness.py::test_face_recognizer_builds_sface_even_on_cloud
======================== 3 failed, 21 passed in 2.63s =========================
